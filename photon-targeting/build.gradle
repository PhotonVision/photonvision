plugins {
    id "java"
    id "cpp"
    id "edu.wpi.first.GradleRIO" version "2024.1.1-beta-3"
    id 'edu.wpi.first.WpilibTools' version '1.3.0'
    id 'edu.wpi.first.NativeUtils' version '2024.2.0'
}

apply from: "${rootDir}/shared/common.gradle"
apply from: "${rootDir}/shared/config.gradle"

model {
    components {
        PhotonTargeting(NativeLibrarySpec) {
            sources {
                cpp {
                    source {
                        srcDirs 'src/main/native/cpp'
                        srcDirs "build/generated/source/proto/main/cpp"
                        include '**/*.cpp', "**/*.cc"
                    }
                    exportedHeaders {
                        srcDirs 'src/main/native/include'
                        srcDirs "build/generated/source/proto/main/cpp"
                        include "**/*.h"
                    }
                }
            }

            nativeUtils.useRequiredLibrary(it, "wpilib_shared")
            nativeUtils.useRequiredLibrary(it, "apriltag_shared")
            nativeUtils.useRequiredLibrary(it, "opencv_shared")
        }
    }
}


java {
    withJavadocJar()
    withSourcesJar()
}

test {
    useJUnitPlatform()
}

apply from: "publish.gradle"
